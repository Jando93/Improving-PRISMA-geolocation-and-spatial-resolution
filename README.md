This repository contains the two main code blocks constituting the processing workflow for the improvement of geolocation accuracy and spatial resolution of PRISMA hyperspectral imagery (https://www.asi.it/scienze-della-terra/prisma/). It is part of the results of research activity carried out in framework of PRISCAV project by the Institute of BioEconomy (IBE) - National Reasearch Council of Italy (CNR) and represents the official repository linked to the scientific paper

"_De Luca, G., Carotenuto, F., Genesio, L., Pepe, M., Toscano, P., Boschetti, M., Miglietta, F., Gioli, B. Improving PRISMA hyperspectral spatial resolution and geolocation by using Sentinel2: development and test of an operational procedure in urban and rural areas. ISPRS Journal of Photogrammetry and Remote Sensing_". 

In particular, the study aimed at the enhancement of PRISMA spatial resolution by employing the spatial and spectral information of the Sentinel-2 MS data. As first step, the proposed workflow involved the correct sub-pixel alignment of the two datasets. For this purpose, the displacements between the two datasets were detected adopting the AROSICS (Automated and Robust Open-Source Image Co-Registration Software) free-available library (https://doi.org/10.3390/rs9070676), built on a phase correlation criterion. Subsequently, the HySure (HS Super Resolution) fusion method (https://doi.org/10.1109/TGRS.2014.2375320), in which the fusion process between PRISMA and Sentinel-2 bands is formulated as the resolution of convex quadratic optimization exploiting subspace-based regularization, was employed to obtain a high spectral and spatial resolution HS dataset. The fusion/pansharpening results were finallly validated comparing them with airborne hyperspectral reference images (CASI/SASI and Hyspex sensors) through specific per-pixel and per-band accuracy metrics (root mean square error, RMSE; spectral angle mapper, SAM; peak signal-to-noise ratio, PSNR; universal image quality index, UIQI).

1) The first code block has been developed via Anaconda (Python v.3.7) (https://www.anaconda.com/). It is an optimized implementation of _COREG_local_ algorithm of AROSICS, in which a composite process for final tie points and a 2th order polynomial function have been integrated to the standard coregistration workflow.
   Mandatory requirements: numpy (https://numpy.org/), geopandas (https://geopandas.org/en/stable/), gdal (https://gdal.org/api/python_bindings.html), AROSICS (https://github.com/GFZ/arosics)
2) The second code block in based on MATLAB. It is an iterative implementation of the HySure code (https://github.com/alfaiate/HySure/blob/master/src/data_fusion.m) for parameter tuning.
   Mandatory requirements: HySure (https://github.com/alfaiate/HySure/tree/master)
3) The third code block is also in Python. It contains the calculation of the accuracy metrics, adopted to validate fusion/pansharpening results by integrating airborne hyperspecteal imagery as reference. 
